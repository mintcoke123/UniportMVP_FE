import{u as Ie,f as Ve,r as l,i as Q,j as e,H as Ae}from"./index-ByU8Wwt0.js";import{g as De,a as X,b as ee,d as Le,e as Ee}from"./voteService-CoZvvvO-.js";import{g as Be,a as q,l as qe}from"./matchingRoomService-C9SRCQv3.js";const Te=3;function We(){const P=Ie(),{user:x}=Ve(),[se,f]=l.useState([]),[te,T]=l.useState(""),[ge,ae]=l.useState(!1),[be,F]=l.useState(!1),[N,R]=l.useState("chat"),[g,w]=l.useState([]),[d,p]=l.useState(null),[pe,re]=l.useState([]),[je,ye]=l.useState(!0),[I,G]=l.useState(null),[V,le]=l.useState(null),[v,k]=l.useState(null),[ne,C]=l.useState(!1),j=l.useRef(null),Ne=s=>s.isJoined===!0||!!x&&s.members.some(t=>t.userId===x.id),o=pe.find(s=>Ne(s)&&s.memberCount<Te),[b,A]=l.useState([]),[we,J]=l.useState(!0),[W,S]=l.useState(null),ve=s=>{const t=parseInt(s.replace(/^room-/,""),10);return Number.isNaN(t)||t<1?void 0:t},ie=W!=null?b.find(s=>s.id===W):b.find(s=>s.status==="started")??b.find(s=>s.status==="full")??b[0],i=ie?ve(ie.id):void 0;l.useEffect(()=>{if(!x||o){A([]),S(null),J(!1);return}J(!0),Be().then(s=>{if(s.length>0){A(s),S(t=>{const a=s.find(r=>r.status==="started")??s.find(r=>r.status==="full")??s[0];return t&&s.some(r=>r.id===t)?t:a.id});return}return q().then(t=>{const a=t.filter(r=>r.isJoined===!0||!!x&&r.members.some(n=>n.userId===x.id));A(a),S(r=>{if(a.length===0)return null;const n=a.find(c=>c.status==="started")??a.find(c=>c.status==="full")??a[0];return r&&a.some(c=>c.id===r)?r:n.id})})}).catch(()=>q().then(s=>{const t=s.filter(a=>a.isJoined===!0||!!x&&a.members.some(r=>r.userId===x.id));A(t),S(a=>{if(t.length===0)return null;const r=t.find(n=>n.status==="started")??t.find(n=>n.status==="full")??t[0];return a&&t.some(n=>n.id===a)?a:r.id})})).finally(()=>J(!1))},[x?.id,!!o]),l.useEffect(()=>{q().then(s=>{re(s),ye(!1)})},[]),l.useEffect(()=>{if(o)return;if(i==null||!x){f([]),w([]),p(null),k(null),C(!1);const a=j.current;a&&(a.close(),j.current=null);return}const s=De(i);if(!s){k(null),X(i).then(a=>f(a)).catch(a=>{f([]),k(a?.message??"채팅을 불러올 수 없습니다.")}),ee(i).then(w),Q(i).then(p).catch(()=>p(null));return}k(null);const t=new WebSocket(s);return j.current=t,t.onopen=()=>{C(!0),X(i).then(a=>f(a)).catch(a=>{f([]),k(a?.message??"이 그룹의 멤버가 아닙니다.")}),ee(i).then(w),Q(i).then(p).catch(()=>p(null))},t.onmessage=a=>{try{const r=JSON.parse(a.data),n=typeof r.id=="number"?r.id:null;if(n==null)return;const c=r.type||"user",u=typeof r.userId=="number"?r.userId:0,L=typeof r.userNickname=="string"?r.userNickname:"",E=typeof r.message=="string"?r.message:void 0,K=typeof r.timestamp=="string"?r.timestamp:"",Y=r.tradeData??null,B={id:n,type:c==="trade"?"trade":"user",userId:u,userNickname:L,message:E??null,timestamp:K,tradeData:Y};f($=>$.some(Z=>Z.id===B.id)?$:[...$,B])}catch{}},t.onclose=()=>{C(!1),j.current=null},t.onerror=()=>{C(!1)},()=>{t.close(),j.current=null,C(!1)}},[o,i,x?.id]);const ke=async s=>{le(s);const t=await qe(s);le(null),G(null),t.success&&q().then(re).catch(()=>{})},[Ce,ce]=l.useState(!1),[h,de]=l.useState(null),[Se,oe]=l.useState(null),xe=l.useRef(null),z=x?.id!=null&&Number(x.id)||0,me=x?.nickname??"나",$e=()=>{xe.current?.scrollIntoView({behavior:"smooth"})};l.useEffect(()=>{$e()},[se]);const[O,ue]=l.useState(!1),he=async()=>{const s=te.trim();if(s===""||i==null||O)return;const t=j.current;if(t?.readyState===WebSocket.OPEN){t.send(JSON.stringify({userId:z,nickname:me,message:s})),T("");return}ue(!0);const a=await Le(i,s);ue(!1),a.success?(T(""),X(i).then(f).catch(()=>{})):alert(a.message??"메시지 전송에 실패했습니다.")},Me=()=>{P("/mock-investment")},U=(s,t)=>{if(i==null)return;const a=g.find(r=>r.id===s);a&&D(a)===t||Ee(i,s,t).then(r=>{if(!r.success){alert(r.message??"투표 반영에 실패했습니다.");return}return ee(i).then(n=>{w(n);const c=n.find(u=>u.id===s&&u.status==="passed");c&&(de(c),ce(!0),Q(i).then(p).catch(()=>{}))})}).catch(()=>alert("투표 반영에 실패했습니다."))},_=(s,t)=>s.votes.filter(a=>a.vote===t).length,D=s=>s.votes.find(a=>a.userId===z)?.vote??null,m=s=>`${s.toLocaleString("ko-KR")}원`,H=s=>`${s>=0?"+":""}${s.toFixed(2)}%`,y=(d?.profitLoss??0)>=0,Pe=(s,t)=>{R("vote")};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ae,{}),e.jsx("main",{className:"flex-1 max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-6",children:je?e.jsx("div",{className:"flex justify-center py-16",children:e.jsx("span",{className:"text-gray-500",children:"불러오는 중..."})}):o?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-teal-100 flex items-center justify-center mb-6",children:e.jsx("i",{className:"ri-user-search-line text-4xl text-teal-600","aria-hidden":!0})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"팀원을 매칭중입니다..."}),e.jsxs("p",{className:"text-gray-500 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-700",children:o.name})," ","방에서 팀원이 모일 때까지 잠시만 기다려 주세요."]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-8",children:["현재 ",o.memberCount,"명 / ",o.capacity,"명"]}),e.jsxs("ul",{className:"flex flex-wrap justify-center gap-4 mb-8",children:[o.members.map(s=>e.jsxs("li",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"w-14 h-14 rounded-full bg-teal-500 text-white flex items-center justify-center text-lg font-semibold shrink-0 border-2 border-white shadow","aria-hidden":!0,children:s.nickname.charAt(0)}),e.jsx("span",{className:"text-sm font-medium text-gray-700 mt-2 truncate max-w-[100px]",children:s.nickname})]},s.userId)),Array.from({length:o.capacity-o.members.length}).map((s,t)=>e.jsxs("li",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center",children:e.jsx("i",{className:"ri-user-add-line text-2xl text-gray-400","aria-hidden":!0})}),e.jsx("span",{className:"text-sm text-gray-400 mt-2",children:"대기 중"})]},`empty-${t}`))]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>P("/matching-rooms"),className:"py-2.5 px-6 rounded-xl text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 cursor-pointer transition-colors",children:"매칭방 목록"}),e.jsx("button",{type:"button",onClick:()=>G(o.id),disabled:V===o.id,className:"py-2.5 px-6 rounded-xl text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:V===o.id?"처리 중...":"방 나가기"})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(0,0.9fr)_minmax(0,1.1fr)] gap-6 lg:h-[calc(100vh-6rem)] min-h-[24rem]",children:[e.jsxs("div",{className:"flex flex-col bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden min-h-0 order-2 lg:order-1",children:[e.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-b border-gray-200",children:e.jsxs("h2",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("i",{className:"ri-pie-chart-line text-teal-500"}),"팀 투자 현황"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 p-4 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-teal-500 to-teal-600 rounded-xl p-4 text-white",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("i",{className:"ri-wallet-3-line text-xl"}),e.jsx("h3",{className:"text-sm font-bold",children:"투자 요약"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-teal-100",children:"투자 원금"}),e.jsx("span",{className:"font-bold",children:m(d?.investmentAmount??0)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-teal-100",children:"현재 평가액"}),e.jsx("span",{className:"font-bold",children:m(d?.totalValue??0)})]}),e.jsxs("div",{className:"border-t border-teal-400 pt-2 flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-teal-100",children:"총 손익"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`font-bold ${y?"text-yellow-300":"text-red-200"}`,children:[y?"+":"",m(d?.profitLoss??0)]}),e.jsx("span",{className:`text-xs ml-1 ${y?"text-yellow-300":"text-red-200"}`,children:H(d?.profitLossPercentage??0)})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900 mb-3",children:"포트폴리오 구성"}),e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsxs("svg",{viewBox:"0 0 200 200",className:"w-28 h-28",children:[(d?.holdings??[]).map((s,t)=>{const a=d?.holdings??[],r=a.reduce((M,Re)=>M+Re.currentValue,0);let n=0;for(let M=0;M<t;M++)n+=a[M].currentValue/r*360;const c=s.currentValue/r*360,u=n+c,L=(n-90)*Math.PI/180,E=(u-90)*Math.PI/180,K=100+80*Math.cos(L),Y=100+80*Math.sin(L),B=100+80*Math.cos(E),$=100+80*Math.sin(E),Z=c>180?1:0,fe=["#14B8A6","#06B6D4","#8B5CF6","#EC4899","#F59E0B","#10B981"];return e.jsx("path",{d:`M 100 100 L ${K} ${Y} A 80 80 0 ${Z} 1 ${B} ${$} Z`,fill:fe[t%fe.length],opacity:"0.9"},s.id)}),e.jsx("circle",{cx:"100",cy:"100",r:"50",fill:"white"})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:(d?.holdings??[]).map((s,t)=>{const a=["bg-teal-500","bg-cyan-500","bg-purple-500","bg-pink-500","bg-amber-500","bg-green-500"],r=(d?.holdings??[]).reduce((c,u)=>c+u.currentValue,0),n=r>0?(s.currentValue/r*100).toFixed(1):"0";return e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${a[t%a.length]}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-gray-900 truncate",children:s.stockName}),e.jsxs("p",{className:"text-xs text-gray-500",children:[n,"%"]})]})]},s.id)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"보유 종목"}),(d?.holdings??[]).map(s=>{const t=s.currentValue-s.averagePrice*s.quantity,a=t/(s.averagePrice*s.quantity)*100,r=t>=0,n=Se===s.id;return e.jsxs("div",{onClick:()=>oe(n?null:s.id),className:`rounded-xl p-3 border transition-all cursor-pointer ${n?"border-teal-500 ring-2 ring-teal-200 bg-teal-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 truncate",children:s.stockName}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.quantity,"주 ·"," ",m(s.currentPrice)]})]}),e.jsx("p",{className:`text-xs font-semibold flex-shrink-0 ml-2 ${r?"text-green-600":"text-red-600"}`,children:H(a)})]}),n&&e.jsxs("button",{onClick:c=>{c.stopPropagation();const u={id:g.length+1,type:"매도",stockName:s.stockName,proposerId:z,proposerName:me,quantity:s.quantity,proposedPrice:s.currentPrice,reason:`${s.stockName} 전량 시장가 매도 제안입니다. 현재 보유 수량 ${s.quantity}주를 모두 처분하고자 합니다.`,createdAt:new Date().toISOString().slice(0,16).replace("T"," "),expiresAt:"24시간 후 만료",votes:[],totalMembers:5,status:"ongoing"};w([u,...g]),oe(null),R("vote")},className:"w-full py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs font-bold rounded-lg hover:from-blue-600 hover:to-blue-700 cursor-pointer",children:[e.jsx("i",{className:"ri-arrow-down-line mr-1"}),"처분 투표 생성"]})]},s.id)})]})]})]}),e.jsxs("div",{className:"flex flex-col min-h-0 order-1 lg:order-2",children:[e.jsxs("header",{className:"flex-none shrink-0 px-4 py-3 flex flex-wrap items-center justify-between gap-3 bg-teal-50 border border-gray-200 border-b-0 rounded-t-2xl rounded-b-none shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("span",{className:"text-sm font-bold text-gray-800 shrink-0",children:"채팅 · 투표"}),b.length>1&&e.jsx("select",{value:W??"",onChange:s=>S(s.target.value||null),className:"text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg px-3 py-1.5 cursor-pointer focus:outline-none focus:ring-2 focus:ring-teal-500 min-w-0 max-w-[12rem]","aria-label":"채팅방 선택",children:b.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.memberCount,"/",s.capacity,")"]},s.id))})]}),e.jsxs("div",{className:"flex bg-white rounded-full p-1 shadow border border-gray-300 flex-1 min-w-0 max-w-[14rem]",children:[e.jsxs("button",{type:"button",onClick:()=>R("chat"),className:`flex-1 py-2 px-3 rounded-full text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${N==="chat"?"bg-teal-500 text-white shadow-sm":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[e.jsx("i",{className:"ri-chat-3-line mr-1","aria-hidden":!0}),"채팅"]}),e.jsxs("button",{type:"button",onClick:()=>R("vote"),className:`flex-1 py-2 px-3 rounded-full text-sm font-medium transition-colors cursor-pointer whitespace-nowrap flex items-center justify-center gap-1 ${N==="vote"?"bg-teal-500 text-white shadow-sm":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[e.jsx("i",{className:"ri-checkbox-circle-line","aria-hidden":!0}),"투표",g.filter(s=>s.status==="ongoing").length>0&&e.jsx("span",{className:`ml-1 px-1.5 py-0.5 text-xs rounded-full ${N==="vote"?"bg-white/20 text-white":"bg-red-500 text-white"}`,children:g.filter(s=>s.status==="ongoing").length})]})]}),e.jsx("button",{type:"button",onClick:()=>F(!0),className:"text-sm text-teal-600 hover:text-teal-700 font-semibold whitespace-nowrap py-1 px-2",children:"채팅방 정보"})]}),e.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full overflow-hidden bg-white rounded-b-2xl rounded-t-none border border-t-0 border-gray-200 shadow-sm",children:[N==="chat"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"flex-shrink-0 px-4 py-3 bg-amber-50 border-b border-amber-200",children:e.jsx("p",{className:"text-sm text-amber-800",children:v})}),i!=null&&!v&&e.jsxs("div",{className:"flex-shrink-0 px-4 py-1.5 border-b border-gray-100 flex items-center gap-2",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${ne?"bg-green-500":"bg-gray-300"}`,"aria-hidden":!0}),e.jsx("span",{className:"text-xs text-gray-500",children:ne?"실시간 연결됨":"연결 중… (메시지는 저장됩니다)"})]}),e.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto overflow-x-hidden px-4 py-3 space-y-4",children:[se.map(s=>e.jsxs("div",{children:[s.type==="user"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"w-10 h-10 rounded-full bg-teal-500 text-white flex items-center justify-center text-sm font-semibold shrink-0","aria-hidden":!0,children:s.userNickname.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.userNickname}),e.jsx("span",{className:"text-xs text-gray-400",children:s.timestamp})]}),e.jsx("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3 shadow-sm border border-gray-100 inline-block max-w-xl",children:e.jsx("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:s.message})})]})]}),s.type==="trade"&&s.tradeData&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"w-10 h-10 rounded-full bg-teal-500 text-white flex items-center justify-center text-sm font-semibold shrink-0","aria-hidden":!0,children:s.userNickname.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.userNickname}),e.jsx("span",{className:"text-xs text-gray-400",children:s.timestamp})]}),e.jsxs("div",{onClick:()=>Pe(s.tradeData,s.userNickname||""),className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-2xl rounded-tl-sm p-4 shadow-sm border border-teal-200 max-w-xl cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${s.tradeData.action==="매수"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,children:[s.tradeData.action," 계획"]})}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"종목"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.tradeData.stockName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"수량"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[s.tradeData.quantity,"주"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"희망 가격"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:m(s.tradeData.pricePerShare)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"주문 금액"}),e.jsx("span",{className:"text-sm font-bold text-teal-600",children:m(s.tradeData.totalAmount)})]})]}),e.jsx("div",{className:"border-t border-teal-200 pt-3 mb-3",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.tradeData.reason})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tradeData.tags.map((t,a)=>e.jsx("span",{className:"px-2 py-1 bg-white text-teal-600 text-xs font-medium rounded-full",children:t},a))})]})]})]})]},s.id)),e.jsx("div",{ref:xe})]}),e.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 p-4",children:e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Me,className:"w-full py-2.5 mb-2 bg-gradient-to-r from-red-500 to-pink-500 text-white text-sm font-bold rounded-xl hover:from-red-600 hover:to-pink-600 cursor-pointer flex items-center justify-center gap-2",children:[e.jsx("i",{className:"ri-stock-line"}),"매수/매도 계획 공유"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:te,onChange:s=>T(s.target.value),onKeyPress:s=>s.key==="Enter"&&he(),placeholder:i==null?b.length===0&&!we?"참가 중인 채팅방이 없습니다. 매칭방에서 팀에 참가해 주세요.":"채팅방 정보를 불러오는 중...":"메시지 입력...",disabled:i==null||O||!!v,className:"flex-1 px-3 py-2.5 bg-gray-100 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 disabled:opacity-60 disabled:cursor-not-allowed"}),e.jsx("button",{type:"button",onClick:he,disabled:i==null||O||!!v,className:"w-10 h-10 bg-teal-500 rounded-xl flex items-center justify-center hover:bg-teal-600 cursor-pointer transition-colors flex-shrink-0 disabled:opacity-60 disabled:cursor-not-allowed",children:e.jsx("i",{className:"ri-send-plane-fill text-white text-lg"})})]})]})})]}),N==="vote"&&e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto overflow-x-hidden p-4 space-y-3",children:g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-checkbox-circle-line text-4xl text-gray-300 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"진행 중인 투표가 없습니다"})]}):e.jsx("div",{className:"space-y-3",children:g.map(s=>e.jsxs("div",{className:`rounded-xl p-4 border ${s.status==="passed"?"border-green-300 bg-green-50":s.status==="rejected"?"border-red-300 bg-red-50":"border-gray-200 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center text-sm font-semibold shrink-0","aria-hidden":!0,children:s.proposerName.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-900 block truncate",children:s.proposerName}),e.jsx("span",{className:"text-xs text-gray-500",children:s.expiresAt})]})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold flex-shrink-0 ${s.type==="매수"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:s.type})]}),e.jsxs("div",{className:"bg-white/80 rounded-lg p-3 mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900 truncate",children:s.stockName}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:[e.jsxs("span",{children:[s.quantity,"주"]}),e.jsx("span",{children:m(s.proposedPrice)})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:s.reason})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:["찬성 ",_(s,"찬성")]}),e.jsxs("span",{className:"text-red-600 font-medium",children:["반대 ",_(s,"반대")]}),e.jsxs("span",{className:"text-gray-500 font-medium",children:["보류 ",_(s,"보류")]}),e.jsxs("span",{className:"text-gray-400",children:[s.votes.length,"/",s.totalMembers]})]}),s.status==="ongoing"?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>U(s.id,"찬성"),className:`flex-1 py-2 rounded-lg text-xs font-bold cursor-pointer ${D(s)==="찬성"?"bg-green-500 text-white":"bg-green-100 text-green-600 hover:bg-green-200"}`,children:"찬성"}),e.jsx("button",{onClick:()=>U(s.id,"보류"),className:`flex-1 py-2 rounded-lg text-xs font-bold cursor-pointer ${D(s)==="보류"?"bg-gray-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"보류"}),e.jsx("button",{onClick:()=>U(s.id,"반대"),className:`flex-1 py-2 rounded-lg text-xs font-bold cursor-pointer ${D(s)==="반대"?"bg-red-500 text-white":"bg-red-100 text-red-600 hover:bg-red-200"}`,children:"반대"})]}):e.jsx("div",{className:`py-2 rounded-lg text-xs font-bold text-center ${s.status==="passed"?"bg-green-500 text-white":s.status==="rejected"?"bg-red-500 text-white":"bg-gray-300 text-gray-600"}`,children:s.status==="passed"?"✓ 통과":s.status==="rejected"?"✗ 부결":"만료"})]},s.id))})})]})]})]})})}),I&&o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-2xl text-amber-600","aria-hidden":!0})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"방에서 나가시겠습니까?"}),e.jsx("p",{className:"text-sm text-gray-500 text-center mb-6",children:"나가시면 해당 방의 팀원 매칭에서 제외됩니다."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>G(null),className:"flex-1 py-2.5 rounded-xl text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 cursor-pointer",children:"취소"}),e.jsx("button",{type:"button",onClick:()=>ke(I),disabled:V===I,className:"flex-1 py-2.5 rounded-xl text-sm font-semibold bg-amber-500 text-white hover:bg-amber-600 disabled:opacity-50 cursor-pointer",children:V===I?"처리 중...":"나가기"})]})]})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-5",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"매수/매도 계획 공유"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"모의투자 페이지에서 매수/매도 계획을 작성하고 공유할 수 있습니다."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>ae(!1),className:"flex-1 py-3 bg-gray-200 text-gray-700 text-sm font-medium rounded-xl hover:bg-gray-300 cursor-pointer whitespace-nowrap transition-colors",children:"닫기"}),e.jsx("button",{onClick:()=>{ae(!1),P("/mock-investment")},className:"flex-1 py-3 bg-teal-500 text-white text-sm font-bold rounded-xl hover:bg-teal-600 cursor-pointer whitespace-nowrap transition-colors",children:"모의투자로 이동"})]})]})}),Ce&&h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-5",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-checkbox-circle-fill text-4xl text-green-500"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"투표 통과!"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["과반수 찬성으로"," ",e.jsx("span",{className:"font-bold",children:h.stockName})," ",h.type," 주문이 체결되었습니다."]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"종목"}),e.jsx("span",{className:"text-sm font-semibold",children:h.stockName})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"유형"}),e.jsx("span",{className:`text-sm font-semibold ${h.type==="매수"?"text-red-600":"text-blue-600"}`,children:h.type})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"수량"}),e.jsxs("span",{className:"text-sm font-semibold",children:[h.quantity,"주"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"체결가"}),e.jsx("span",{className:"text-sm font-semibold",children:m(h.proposedPrice)})]})]}),e.jsx("button",{onClick:()=>{ce(!1),de(null)},className:"w-full py-3 bg-teal-500 text-white text-sm font-bold rounded-xl hover:bg-teal-600 cursor-pointer whitespace-nowrap transition-colors",children:"확인"})]})}),be&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-5",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"채팅방 정보"}),e.jsx("button",{onClick:()=>F(!1),className:"w-8 h-8 flex items-center justify-center cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-xl text-gray-700"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-200",children:[e.jsx("span",{className:"w-16 h-16 rounded-full bg-teal-500 text-white flex items-center justify-center text-xl font-bold shrink-0","aria-hidden":!0,children:(d?.groupName??"").charAt(0)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-bold text-gray-900",children:d?.groupName??"-"}),e.jsx("span",{className:"text-sm text-gray-500",children:"멤버 5명"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"ri-wallet-3-line text-teal-600 text-lg"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"팀 투자 현황"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"팀 투자금(실시간)"}),e.jsx("span",{className:"text-base font-bold text-gray-900",children:m(d?.investmentAmount??0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"전체 자산"}),e.jsx("span",{className:"text-base font-bold text-gray-900",children:m(d?.totalValue??0)})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-teal-200",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"투자 손익"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`text-base font-bold ${y?"text-green-600":"text-red-600"}`,children:[y?"+":"",m(d?.profitLoss??0)]}),e.jsx("span",{className:`text-xs ml-2 ${y?"text-green-600":"text-red-600"}`,children:H(d?.profitLossPercentage??0)})]})]})]})]}),e.jsx("button",{onClick:()=>{F(!1),P("/group-portfolio")},className:"w-full py-3 bg-teal-500 text-white text-sm font-bold rounded-xl hover:bg-teal-600 cursor-pointer whitespace-nowrap transition-colors",children:"그룹 포트폴리오 보기"})]})]})})]})}export{We as default};
//# sourceMappingURL=page-CXkAuYU-.js.map
