import{d,u as F,r as a,j as e,H as L}from"./index-DZLemZV3.js";async function M(){return await d("/api/market/indices")}async function _(){return await d("/api/market/stocks?sort=volume")}async function H(){return await d("/api/market/stocks?sort=rising")}async function T(){return await d("/api/market/stocks?sort=falling")}function Q(){const f=F(),[j,N]=a.useState([]),[u,v]=a.useState([]),[w,k]=a.useState([]),[S,C]=a.useState([]),[l,m]=a.useState("volume"),[n,x]=a.useState(""),I=a.useRef(null),[p,y]=a.useState(null);a.useEffect(()=>{y(null);const s=[M(),_(),H(),T()];Promise.allSettled(s).then(([t,g,c,o])=>{const P=t.status==="fulfilled"?t.value:[],R=g.status==="fulfilled"?g.value:[],B=c.status==="fulfilled"?c.value:[],E=o.status==="fulfilled"?o.value:[];N(P),v(R),k(B),C(E);const r=[];if(t.status==="rejected"&&r.push("시장 지수"),g.status==="rejected"&&r.push("거래량 순위"),c.status==="rejected"&&r.push("상승률 순위"),o.status==="rejected"&&r.push("하락률 순위"),r.length>0){const A=`${r.join(", ")}를 불러오지 못했습니다.`,K=[c,o].some(h=>h.status==="rejected"&&(h.reason?.message?.includes("KIS")||h.reason?.status===503))?" (한국투자증권 KIS API 미설정 시 상승/하락 순위는 불가. 백엔드에 KIS_API_APPKEY, KIS_API_APPSECRET 설정 필요)":"";y(A+K)}})},[]);const b=()=>{let s;switch(l){case"volume":s=u;break;case"rising":s=w;break;case"falling":s=S;break;default:s=u}return n.trim()?s.filter(t=>t.name.toLowerCase().includes(n.toLowerCase())||t.code.includes(n)):s},i=s=>s.toLocaleString("ko-KR"),$=s=>{f(`/stock-detail?id=${s.id}`,{state:{nameFromList:s.name}})};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(L,{}),e.jsxs("main",{className:"pt-8 pb-12 px-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"모의투자"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"종목을 선택해 매수·매도 체험을 해보세요"})]}),p&&e.jsxs("div",{className:"mb-6 bg-amber-50 border border-amber-200 text-amber-800 text-sm px-4 py-3 rounded-xl flex items-center gap-2",children:[e.jsx("i",{className:"ri-error-warning-line"}),p]}),e.jsx("section",{className:"mb-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-700 mb-4",children:"시장 지수"}),e.jsx("div",{className:"grid grid-cols-3 gap-6",children:j.map(s=>e.jsxs("div",{className:"text-center py-3 px-4 rounded-xl bg-gray-50",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.name}),e.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:i(s.value)}),e.jsxs("p",{className:`text-sm font-semibold ${s.change>=0?"text-red-600":"text-blue-600"}`,children:[s.change>=0?"+":"",i(s.change)," (",s.change>=0?"+":"",s.changeRate,"%)"]})]},s.id))})]})}),e.jsxs("section",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-5 border-b border-gray-100",children:[e.jsxs("div",{className:"flex rounded-xl bg-gray-100 p-1",children:[e.jsx("button",{onClick:()=>m("volume"),className:`py-2 px-5 rounded-lg text-sm font-semibold transition-all cursor-pointer whitespace-nowrap ${l==="volume"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"거래량"}),e.jsx("button",{onClick:()=>m("rising"),className:`py-2 px-5 rounded-lg text-sm font-semibold transition-all cursor-pointer whitespace-nowrap ${l==="rising"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"급상승"}),e.jsx("button",{onClick:()=>m("falling"),className:`py-2 px-5 rounded-lg text-sm font-semibold transition-all cursor-pointer whitespace-nowrap ${l==="falling"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"급하락"})]}),e.jsxs("div",{className:"flex-1 min-w-[200px] max-w-md relative",children:[e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg pointer-events-none"}),e.jsx("input",{ref:I,type:"text",value:n,onChange:s=>x(s.target.value),placeholder:"종목명 또는 종목코드 검색",className:"w-full py-2.5 pl-10 pr-4 bg-gray-100 rounded-xl text-sm text-gray-900 placeholder-gray-500 outline-none focus:ring-2 focus:ring-teal-500 focus:bg-white border border-transparent"}),n&&e.jsx("button",{onClick:()=>x(""),className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 flex items-center justify-center cursor-pointer text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-circle-fill"})})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 px-6 py-3 bg-gray-50 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:[e.jsx("div",{className:"col-span-1",children:"순위"}),e.jsx("div",{className:"col-span-4",children:"종목"}),e.jsx("div",{className:"col-span-2 text-right",children:"현재가"}),e.jsx("div",{className:"col-span-2 text-right",children:"등락"}),e.jsx("div",{className:"col-span-3 text-right",children:"등락률"})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:b().length>0?b().map((s,t)=>e.jsxs("div",{onClick:()=>$(s),className:"grid grid-cols-1 md:grid-cols-12 gap-2 md:gap-4 px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors items-center",children:[e.jsx("span",{className:"hidden md:block text-sm font-medium text-gray-500 col-span-1",children:t+1}),e.jsxs("div",{className:"flex items-center gap-3 md:col-span-4 col-span-1",children:[e.jsx("span",{className:"md:hidden text-sm font-medium text-gray-500 w-6",children:t+1}),e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center text-white font-bold text-sm flex-shrink-0",style:{backgroundColor:s.logoColor},children:s.name.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.code})]})]}),e.jsxs("div",{className:"md:text-right md:col-span-2",children:[e.jsx("p",{className:"md:hidden text-xs text-gray-500 mb-0.5",children:"현재가"}),e.jsxs("p",{className:"font-bold text-gray-900",children:[i(s.currentPrice),"원"]})]}),e.jsxs("div",{className:"md:text-right md:col-span-2",children:[e.jsx("p",{className:"md:hidden text-xs text-gray-500 mb-0.5",children:"등락"}),e.jsxs("p",{className:`font-semibold ${s.change>=0?"text-red-600":"text-blue-600"}`,children:[s.change>=0?"+":"",i(s.change)]})]}),e.jsxs("div",{className:"md:text-right md:col-span-3",children:[e.jsx("p",{className:"md:hidden text-xs text-gray-500 mb-0.5",children:"등락률"}),e.jsxs("p",{className:`font-semibold ${s.change>=0?"text-red-600":"text-blue-600"}`,children:[s.change>=0?"+":"",s.changeRate.toFixed(2),"%"]})]})]},`${l}-${s.code}-${t}`)):e.jsxs("div",{className:"py-16 text-center",children:[e.jsx("i",{className:"ri-search-line text-5xl text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"검색 결과가 없습니다"}),e.jsx("button",{onClick:()=>x(""),className:"mt-3 text-sm text-teal-600 font-medium hover:text-teal-700 cursor-pointer",children:"검색어 지우기"})]})})]})]})]})}export{Q as default};
//# sourceMappingURL=page-BtENeANk.js.map
