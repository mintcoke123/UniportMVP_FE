import{u as H,f as P,r as l,i as u,j as e,H as T,k as _,l as $,s as J,m as U}from"./index-CzCyzncT.js";const v=3;function Y(){const C=H(),{updateUserTeam:k,user:n}=P(),[h,d]=l.useState([]),[f,R]=l.useState(!0),[i,r]=l.useState(null),[S,o]=l.useState(!1),[p,b]=l.useState(""),[y,j]=l.useState(!1),[x,g]=l.useState(null);l.useEffect(()=>{u().then(t=>{d(t),R(!1)})},[]);const A=async t=>{if(!n)return;r(t);const s=await _(t,{id:n.id,nickname:n.nickname});r(null),s.success?u().then(d):alert(s.message)},I=async t=>{r(t);const s=await $(t);r(null),g(null),s.success&&u().then(d)},N=t=>g(t),M=()=>g(null),L=async t=>{r(t);const s=await J(t);r(null),s.success&&(s.teamId&&k(s.teamId),C("/mock-investment"))},E=async()=>{j(!0);const t=await U(p.trim()||void 0);j(!1),t.success&&(o(!1),b(""),u().then(d))},F=t=>t.memberCount>=v,w=t=>n&&t.members.some(s=>s.userId===n.id),a=h.find(t=>w(t)&&t.memberCount<v);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(T,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[!f&&a?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-teal-100 flex items-center justify-center mb-6",children:e.jsx("i",{className:"ri-user-search-line text-4xl text-teal-600","aria-hidden":!0})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"팀원을 매칭중입니다..."}),e.jsxs("p",{className:"text-gray-500 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-700",children:a.name})," ","방에서 팀원이 모일 때까지 잠시만 기다려 주세요."]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-8",children:["현재 ",a.memberCount,"명 / ",a.capacity,"명"]}),e.jsxs("ul",{className:"flex flex-wrap justify-center gap-4 mb-8",children:[a.members.map(t=>e.jsxs("li",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"w-14 h-14 rounded-full bg-teal-500 text-white flex items-center justify-center text-lg font-semibold shrink-0 border-2 border-white shadow","aria-hidden":!0,children:t.nickname.charAt(0)}),e.jsx("span",{className:"text-sm font-medium text-gray-700 mt-2 truncate max-w-[100px]",children:t.nickname})]},t.userId)),Array.from({length:a.capacity-a.members.length}).map((t,s)=>e.jsxs("li",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center",children:e.jsx("i",{className:"ri-user-add-line text-2xl text-gray-400","aria-hidden":!0})}),e.jsx("span",{className:"text-sm text-gray-400 mt-2",children:"대기 중"})]},`empty-${s}`))]}),e.jsx("button",{type:"button",onClick:()=>N(a.id),disabled:i===a.id,className:"py-2.5 px-6 rounded-xl text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:i===a.id?"처리 중...":"방 나가기"})]}):f?e.jsx("div",{className:"flex justify-center py-16",children:e.jsx("span",{className:"text-gray-500",children:"목록 불러오는 중..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"매칭방 목록"}),e.jsxs("button",{type:"button",onClick:()=>o(!0),className:"py-2.5 px-5 rounded-xl text-sm font-semibold bg-teal-500 text-white hover:bg-teal-600 cursor-pointer transition-colors flex items-center gap-2",children:[e.jsx("i",{className:"ri-add-line text-lg","aria-hidden":!0}),"방 만들기"]})]}),h.length===0?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-12 text-center",children:[e.jsx("p",{className:"text-gray-500",children:"진행 중인 매칭방이 없습니다."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"새 매칭방이 생성되면 여기에 표시됩니다."}),e.jsx("button",{type:"button",onClick:()=>o(!0),className:"mt-4 py-2.5 px-5 rounded-xl text-sm font-semibold bg-teal-500 text-white hover:bg-teal-600 cursor-pointer",children:"방 만들기"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(t=>{const s=F(t),c=i===t.id;return e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 truncate",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["멤버 ",t.memberCount,"/",t.capacity,"명",t.status==="full"&&e.jsx("span",{className:"ml-2 text-teal-600 font-medium",children:"· 모의투자 시작 가능"}),t.status==="started"&&e.jsx("span",{className:"ml-2 text-gray-500",children:"· 진행 중"})]})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-3",children:"멤버"}),e.jsxs("ul",{className:"space-y-3",children:[t.members.map(m=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-10 h-10 rounded-full bg-teal-500 text-white flex items-center justify-center text-sm font-semibold shrink-0","aria-hidden":!0,children:m.nickname.charAt(0)}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m.nickname})})]},m.userId)),t.members.length<t.capacity&&Array.from({length:t.capacity-t.members.length}).map((m,z)=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 border-2 border-dashed border-gray-200 flex-shrink-0 flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-400",children:"빈 자리"})}),e.jsx("p",{className:"text-sm text-gray-400",children:"대기 중"})]},`empty-${z}`))]})]}),e.jsx("div",{className:"p-5 pt-0 flex gap-2",children:t.status==="started"?e.jsx("button",{type:"button",disabled:!0,className:"flex-1 py-2.5 rounded-xl text-sm font-medium bg-gray-100 text-gray-500 cursor-not-allowed",children:"진행 중"}):s?w(t)?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>L(t.id),disabled:c,className:"flex-1 py-2.5 rounded-xl text-sm font-bold bg-teal-500 text-white hover:bg-teal-600 disabled:opacity-50 cursor-pointer transition-colors",children:c?"처리 중...":"모의투자 시작"}),e.jsx("button",{type:"button",onClick:()=>N(t.id),disabled:c,className:"py-2.5 px-4 rounded-xl text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-50 cursor-pointer transition-colors",children:"나가기"})]}):e.jsx("button",{type:"button",disabled:!0,className:"w-full py-2.5 rounded-xl text-sm font-medium bg-gray-100 text-gray-400 cursor-not-allowed",title:"방이 가득 찼습니다",children:"참가 불가 (3/3)"}):e.jsx("button",{type:"button",onClick:()=>A(t.id),disabled:c,className:"w-full py-2.5 rounded-xl text-sm font-bold bg-teal-500 text-white hover:bg-teal-600 disabled:opacity-50 cursor-pointer transition-colors",children:c?"처리 중...":"참가하기"})})]},t.id)})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-error-warning-line text-2xl text-amber-600","aria-hidden":!0})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"방에서 나가시겠습니까?"}),e.jsx("p",{className:"text-sm text-gray-500 text-center mb-6",children:"나가시면 해당 방의 팀원 매칭에서 제외됩니다. 다시 참가하려면 방에 새로 참가해야 합니다."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:M,className:"flex-1 py-2.5 rounded-xl text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 cursor-pointer",children:"취소"}),e.jsx("button",{type:"button",onClick:()=>I(x),disabled:i===x,className:"flex-1 py-2.5 rounded-xl text-sm font-semibold bg-amber-500 text-white hover:bg-amber-600 disabled:opacity-50 cursor-pointer",children:i===x?"처리 중...":"나가기"})]})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"모의투자방 만들기"}),e.jsx("input",{type:"text",value:p,onChange:t=>b(t.target.value),placeholder:"방 이름 (선택)",className:"w-full px-4 py-3 border border-gray-300 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 mb-4"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"비우면 자동으로 날짜 기반 이름이 붙습니다. 정원 3명이 모이면 모의투자를 시작할 수 있습니다."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{o(!1),b("")},className:"flex-1 py-2.5 rounded-xl text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 cursor-pointer",children:"취소"}),e.jsx("button",{type:"button",onClick:E,disabled:y,className:"flex-1 py-2.5 rounded-xl text-sm font-semibold bg-teal-500 text-white hover:bg-teal-600 disabled:opacity-50 cursor-pointer",children:y?"만드는 중...":"만들기"})]})]})})]})]})}export{Y as default};
//# sourceMappingURL=page-CqQfRtxQ.js.map
